<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Project Euler Problem 30 &#8211; Art is Never Finished</title>
<meta name="description" content="Problem 30 was another very short problem. We just need to find the sum of all numbers that are equal to the sum of the fifth powers of their digits. The only real hard part is to decide at what point we should stop searching. I just arbitrarily picked 1,000,000, and wrote the following.

(use '[clojure.contrib.math :only (expt)])


">
<meta name="keywords" content="digits, powers">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Project Euler Problem 30">
<meta name="twitter:description" content="Problem 30 was another very short problem. We just need to find the sum of all numbers that are equal to the sum of the fifth powers of their digits. The only real hard part is to decide at what point we should stop searching. I just arbitrarily picked 1,000,000, and wrote the following.

(use '[clojure.contrib.math :only (expt)])


">
<meta name="twitter:site" content="@ivarthorson">
<meta name="twitter:creator" content="@ivarthorson">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Project Euler Problem 30">
<meta property="og:description" content="Problem 30 was another very short problem. We just need to find the sum of all numbers that are equal to the sum of the fifth powers of their digits. The only real hard part is to decide at what point we should stop searching. I just arbitrarily picked 1,000,000, and wrote the following.

(use '[clojure.contrib.math :only (expt)])


">
<meta property="og:url" content="/project-euler/problem-30/">
<meta property="og:site_name" content="Art is Never Finished">





<link rel="canonical" href="/project-euler/problem-30/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Art is Never Finished Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="/assets/js/vendor/html5shiv.min.js"></script>
  <script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<!-- MathJax -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="/about/" >About</a></li>
		  
		    
		    <li><a href="/blog/" >Blog</a></li>
		  
		    
		    <li><a href="/project-euler/" >Code</a></li>
		  
		    
		    <li><a href="/search/" >Search</a></li>
		  
		    
		    <li><a href="/tags/" >Tags</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
      <h1 class="site-title animated fadeIn"><a href="/">Art is Never Finished</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">...Only Abandoned. – Leonardo da Vinci</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
          <li><a href="/tags/#digits" title="Pages tagged digits">digits</a></li><li><a href="/tags/#powers" title="Pages tagged powers">powers</a></li>
        </ul>
        
          <h1 class="entry-title">Project Euler Problem 30</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <img src="/images/ivar.jpg" class="bio-photo" alt="Ivar Thorson bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Ivar Thorson</span></span>
        <span class="entry-date date published"><time datetime="2010-07-17T07:43:47-07:00"><i class="fa fa-calendar-o"></i> July 17, 2010</time></span>
        
        
        
        
      </footer>
      <div class="entry-content">
        <p><a href="http://projecteuler.net/index.php?section=problems&amp;id=30">Problem 30</a> was another very short problem. We just need to find the sum of all numbers that are equal to the sum of the fifth powers of their digits. The only real hard part is to decide at what point we should stop searching. I just arbitrarily picked 1,000,000, and wrote the following.</p>

<pre><code>(<span style="color: #729fcf;">use</span> '[clojure.contrib.math <span style="color: #729fcf;">:only</span> (expt)])

(<span style="color: #8ae234;">defn</span> <span style="color: #edd400; font-weight: bold;">as-digits</span> [num]
  (<span style="color: #729fcf;">map</span> #(Character/getNumericValue %) (<span style="color: #729fcf;">str</span> num)))

(<span style="color: #8ae234;">defn</span> <span style="color: #edd400; font-weight: bold;">sum-of-fifth-powers?</span> [num]
  (<span style="color: #729fcf;">=</span> num (<span style="color: #729fcf;">reduce</span> + (<span style="color: #729fcf;">map</span> #(expt % 5) (as-digits num)))))

(<span style="color: #8ae234;">defn</span> <span style="color: #edd400; font-weight: bold;">euler-30</span> []
  (<span style="color: #729fcf;">reduce</span> + (<span style="color: #729fcf;">filter</span> sum-of-fifth-powers? (<span style="color: #729fcf;">range</span> 10 1000000))))

(euler-30)</code></pre>

<p>By sheer luck my original guess of 1,000,000 turned out to be a safe upper search bound, although more conservative than necessary. If you can’t figure out why, see  <a href="http://clojure-euler.wikispaces.com/Problem+030">sammay’s explanation on clojure-euler</a>.</p>

<p>Performance of my solution is pretty bad (45 seconds to compute the answer). What can we do to improve speed? Well, we are computing the fifth powers of the numbers 1 to 9 over and over again, which is redundant computation. If we pushed those into map, we could replace an expensive computation with a simple lookup. The other major optimizations would be to stop our search earlier than 1,000,000, and to avoid unnecessary conversion between character and integer types.</p>

<p>Once again, somebody on clojure-euler has beaten us to the punch, and provided this very concise definition that accomplishes all three of these optimizations:</p>

<pre><code><span style="color: #A8AaA5;">;; </span><span style="color: #A8AaA5;">Thanks, rafsoaken!
</span>(<span style="color: #8ae234;">defn</span> <span style="color: #edd400; font-weight: bold;">euler-30-rafsoaken</span> []
  (<span style="color: #8ae234;">let</span> [pow5 (<span style="color: #729fcf;">apply</span> hash-map (<span style="color: #729fcf;">interleave</span> (<span style="color: #729fcf;">seq</span> <span style="color: #Fd7f98;">"0123456789"</span>) 
                                         (<span style="color: #729fcf;">map</span> #(Math/pow % 5) (<span style="color: #729fcf;">range</span> 10))))
        max  (<span style="color: #8ae234;">-&gt;</span> \9 pow5 (<span style="color: #729fcf;">*</span> 6))]
    (<span style="color: #729fcf;">reduce</span> + (<span style="color: #729fcf;">filter</span> #(<span style="color: #729fcf;">=</span> % (<span style="color: #729fcf;">reduce</span> + (<span style="color: #729fcf;">map</span> pow5 (<span style="color: #729fcf;">str</span> %)))) 
                      (<span style="color: #729fcf;">range</span> 2 max) ))))</code></pre>

<p>This takes less than a second to execute on my machine, easily 50 times faster than my first solution.</p>

        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="/project-euler/problem-29/" class="btn" title="Project Euler Problem 29">Previous</a>
      
      
        <a href="/project-euler/problem-31/" class="btn" title="Project Euler Problem 31">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<div>&copy; 2017 Ivar Thorson. </div>
<div class="legaltext">Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using a modified version of the <a href="https://mademistakes.com/work/so-simple-jekyll-theme/" rel="nofollow">So Simple Theme</a>.</div>
<div class="social-icons">
	<a href="https://twitter.com/ivarthorson" title="Ivar Thorson on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	
	
	
	
	
	
	<a href="https://github.com/ivarthorson" title="Ivar Thorson on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  
	
  <a href="/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = '';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>




</body>
</html>
