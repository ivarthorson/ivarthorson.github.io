<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Project Euler Problem 69 &#8211; Art is Never Finished</title>
<meta name="description" content="After a long and wonderful three week vacation (and another week of just getting back into the flow), it’s time to return to the daily little bit of practice to stay sharp. Let’s get started!
">
<meta name="keywords" content="primes, totient">


<!-- Twitter Cards -->
<meta name="twitter:title" content="Project Euler Problem 69">
<meta name="twitter:description" content="After a long and wonderful three week vacation (and another week of just getting back into the flow), it’s time to return to the daily little bit of practice to stay sharp. Let’s get started!
">
<meta name="twitter:site" content="@ivarthorson">
<meta name="twitter:creator" content="@ivarthorson">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Project Euler Problem 69">
<meta property="og:description" content="After a long and wonderful three week vacation (and another week of just getting back into the flow), it’s time to return to the daily little bit of practice to stay sharp. Let’s get started!
">
<meta property="og:url" content="/project-euler/problem-69/">
<meta property="og:site_name" content="Art is Never Finished">





<link rel="canonical" href="/project-euler/problem-69/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Art is Never Finished Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="/assets/js/vendor/html5shiv.min.js"></script>
  <script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<!-- MathJax -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		    <li><a href="/about/" >About</a></li>
		  
		    
		    <li><a href="/blog/" >Blog</a></li>
		  
		    
		    <li><a href="/project-euler/" >Code</a></li>
		  
		    
		    <li><a href="/search/" >Search</a></li>
		  
		    
		    <li><a href="/tags/" >Tags</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
      <h1 class="site-title animated fadeIn"><a href="/">Art is Never Finished</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">...Only Abandoned. – Leonardo da Vinci</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <ul class="entry-tags">
          <li><a href="/tags/#primes" title="Pages tagged primes">primes</a></li><li><a href="/tags/#totient" title="Pages tagged totient">totient</a></li>
        </ul>
        
          <h1 class="entry-title">Project Euler Problem 69</h1>
        
      </header>
      <footer class="entry-meta">
        
        
          <img src="/images/ivar.jpg" class="bio-photo" alt="Ivar Thorson bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Ivar Thorson</span></span>
        <span class="entry-date date published"><time datetime="2010-10-06T18:00:25+00:00"><i class="fa fa-calendar-o"></i> October 06, 2010</time></span>
        
        
        
        
      </footer>
      <div class="entry-content">
        <p>After a long and wonderful three week vacation (and another week of just getting back into the flow), it’s time to return to the daily little bit of practice to stay sharp. Let’s get started!</p>

<p><a href="http://projecteuler.net/index.php?section=problems&amp;id=69">Problem 69</a> wasn’t a programming problem at all, it was a math problem. One could solve it with a few minutes of logic, a pencil, and paper.</p>

<p>The key insight is that multiplying small primes together will result in products with the fewest number of relative primes. Because a small phi will maximize <code class="language-plaintext highlighter-rouge">n/phi(n)</code>, our answer is in fact simply the product of the first few primes.</p>

<pre><code>(<span style="color: #729fcf;">use</span> '[clojure.contrib.lazy-seqs <span style="color: #729fcf;">:only</span> (primes)])

(<span style="color: #8ae234;">defn</span> <span style="color: #edd400; font-weight: bold;">euler-69</span> []
  (<span style="color: #729fcf;">last</span> (<span style="color: #729fcf;">take-while</span> #(<span style="color: #729fcf;">&lt;</span> % 1e6) (reductions * primes))))

(<span style="color: #729fcf;">time</span> (euler-69)) <span style="color: #A8AaA5;">;; </span><span style="color: #A8AaA5;">"Elapsed time: 0.263869 msecs"
</span></code></pre>

<p>I really was pleased when I realized how <code class="language-plaintext highlighter-rouge">reductions</code> made this code a one-liner. Problem solved!</p>

<p>Although not really necessary, if you need some help or insight into the totient function, you might enjoy playing with these functions, as I did.</p>

<pre><code>(<span style="color: #8ae234;">defn</span> <span style="color: #edd400; font-weight: bold;">coprime?</span> [p q]
  {<span style="color: #729fcf;">:pre</span> [(<span style="color: #729fcf;">&lt;</span> 0 p) (<span style="color: #729fcf;">&lt;</span> 0 q)]}
  (<span style="color: #729fcf;">not-any?</span> #(<span style="color: #8ae234;">and</span> (zero? (<span style="color: #729fcf;">rem</span> p %))
                  (zero? (<span style="color: #729fcf;">rem</span> q %)))
            (<span style="color: #729fcf;">take-while</span> #(<span style="color: #729fcf;">&lt;=</span> (<span style="color: #729fcf;">*</span> 2 %) p) primes)))

(<span style="color: #8ae234;">defn</span> <span style="color: #edd400; font-weight: bold;">brute-totient</span> [n]
  (<span style="color: #729fcf;">count</span> (<span style="color: #729fcf;">filter</span> #(coprime? n %) (<span style="color: #729fcf;">range</span> 1 n))))</code></pre>

<p>Of course, it’s much wiser to use an analytic equation for the totient of larger numbers (read up on Euler Products):</p>

<pre><code><span style="color: #A8AaA5;">;; </span><span style="color: #A8AaA5;">Prime-factors-of from problem 12
</span>(<span style="color: #8ae234;">defn</span> <span style="color: #edd400; font-weight: bold;">prime-factors-of</span>
  <span style="color: #888a85;">"Returns a sorted list of prime factors of num, including multiplicity."</span>
  [num]
  (<span style="color: #8ae234;">let</span> [q (Math/sqrt num)
        factor? (<span style="color: #729fcf;">fn</span> [nom den] (zero? (<span style="color: #729fcf;">rem</span> nom den)))] 
    (<span style="color: #8ae234;">loop</span> [n num
           d 2
           r []]
      (<span style="color: #8ae234;">cond</span>
       (<span style="color: #729fcf;">&gt;</span> d q) (<span style="color: #729fcf;">concat</span> r [n]) 
       (<span style="color: #729fcf;">=</span> n d) (<span style="color: #729fcf;">concat</span> r [n])      
       (factor? n d) (<span style="color: #8ae234;">recur</span> (<span style="color: #729fcf;">/</span> n d) d (<span style="color: #729fcf;">conj</span> r d)) 
       true          (<span style="color: #8ae234;">recur</span> n (<span style="color: #729fcf;">inc</span> d) r)))))

(<span style="color: #8ae234;">defn</span> <span style="color: #edd400; font-weight: bold;">unique-prime-factors-of</span> [n]
  (<span style="color: #729fcf;">vec</span> (<span style="color: #729fcf;">into</span> #{} (prime-factors-of n))))

(<span style="color: #8ae234;">defn</span> <span style="color: #edd400; font-weight: bold;">euler-totient</span> [n]
  (<span style="color: #729fcf;">*</span> n (<span style="color: #729fcf;">reduce</span> * (<span style="color: #729fcf;">map</span> #(<span style="color: #729fcf;">-</span> 1 (<span style="color: #729fcf;">/</span> 1 %)) (unique-prime-factors-of n)))))</code></pre>

<p>Ciao for today!</p>


        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="/project-euler/problem-68/" class="btn" title="Project Euler Problem 68">Previous</a>
      
      
        <a href="/project-euler/problem-70/" class="btn" title="Project Euler Problem 70">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<div>&copy; 2020 Ivar Thorson. </div>
<div class="legaltext">Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using a modified version of the <a href="https://mademistakes.com/work/so-simple-jekyll-theme/" rel="nofollow">So Simple Theme</a>.</div>
<div class="social-icons">
	<a href="https://twitter.com/ivarthorson" title="Ivar Thorson on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	
	
	
	
	
	
	<a href="https://github.com/ivarthorson" title="Ivar Thorson on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  
	
  <a href="/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = '';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>




</body>
</html>
